package de.randombyte.sglvertretungsplan;

import android.content.Context;
import android.support.annotation.NonNull;
import android.support.annotation.Nullable;
import android.util.Log;

import com.google.common.base.CharMatcher;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.nodes.Node;
import org.jsoup.nodes.TextNode;
import org.jsoup.select.Elements;
import org.roboguice.shaded.goole.common.collect.Lists;

import java.util.Calendar;
import java.util.List;

import javax.security.auth.login.LoginException;

import de.randombyte.sglvertretungsplan.models.Day;
import de.randombyte.sglvertretungsplan.models.Login;
import de.randombyte.sglvertretungsplan.models.TimetableInfo;
import de.randombyte.sglvertretungsplan.models.Vertretung;
import de.randombyte.sglvertretungsplan.models.Vertretungsplan;
import de.randombyte.sglvertretungsplan.models.VertretungsplanAndLogin;
import roboguice.util.RoboAsyncTask;

public abstract class VertretungsplanDownloader extends RoboAsyncTask<VertretungsplanAndLogin> {

    public static final int COLUMNS_COUNT = 9;
    
    private final Login login;

    protected VertretungsplanDownloader(Context context, Login login) {
        super(context);
        this.login = login;
    }

    // The only method called by RoboAsyncTask asyncly
    @Override
    public VertretungsplanAndLogin call() throws Exception {

        Vertretungsplan vertretungsplan = new Vertretungsplan();

        for (TimetableInfo timetableInfo : login.loadLinks()) {
            Log.d("urls", timetableInfo.getUrl());
            if (Login.isBadLink(timetableInfo.getUrl())) {
                throw new LoginException("Service returned NoContent! Assuming bad credentials");
            }

            Day day = new Day();
            day.setDownloadedTimeStamp(Calendar.getInstance().getTimeInMillis());
            day.setTimetableInfo(timetableInfo);

            Document vertretungsplanDoc = Jsoup.connect(timetableInfo.getUrl()).get();
            //noMotds Document vertretungsplanDoc = Jsoup.parse("<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\"><style type=\"text/css\">body { margin-top: 0px; margin-left: 20px; margin-right: 20px;background: #fff; color: #272727; font: 80% Arial, Helvetica, sans-serif; }h1 { color: #ee7f00; font-size: 150%; font-weight: normal;}h1 strong { font-size: 200%; font-weight: normal; }h2 { font-size: 125%;}h1, h2 { margin: 0; padding: 0;}th { background: #000; color: #fff; }table.mon_list th, td { padding: 8px 4px;}.mon_title { font-weight: bold; font-size: 120%; clear: both; margin: 0; }.inline_header{font-weight: bold; }table.info{color: #000000; font-size: 100%;border: 1px;border-style:solid;border-collapse:collapse;padding: 8px 4px;}table.mon_list{color: #000000; width: 100%; font-size: 100%;border: 1px;border-style:solid;border-collapse:collapse;}table.mon_head{color: #000000; width: 100%; font-size: 100%;}td.info,th.list,td.list,tr.list{border: 1px;border-style: solid;border-color: black;margin: 0px;border-collapse:collapse;padding: 3px;}tr.odd { background: #fad3a6; }tr.even { background: #fdecd9; }</style></head><body ><table class=\"mon_head\">    <tr>        <td valign=\"bottom\"><h1><strong>Untis</strong> 2016 <!-- Info-Stundenplan --></h1></td>        <td valign=\"bottom\"></td>        <td align=\"right\" valign=\"bottom\">            <p>STÃ„DT. GYMNASIUM LÃ–HNE <span style=\"width:10px\">&nbsp;</span> D-32584, A.-SCHWEITZER-STR.16<br />            1. Halbjahr 15/16<span style=\"width:10px\">&nbsp;</span> <span style=\"width:10px\">&nbsp;</span> Stand: 23.09.2015 07:03</p>        </td>    </tr></table><center><div class=\"mon_title\">24.9.2015 Donnerstag, Woche A (Seite 1 / 5)</div><table class=\"info\" ><tr class=\"info\"><th class=\"info\" align=\"center\" colspan=\"2\">Nachrichten zum Tag</th></tr><tr class=\"info\"><td class=\"info\" align=\"left\">Abwesende Lehrer&nbsp;</td><td class=\"info\" align=\"left\">BER, BEV, BIE, BRO, BSH, EVA, FIE, KEU, LAN, LIN, MYR, NEU (7-10), PAP, SHI, SPE, STR, SUN</td></tr><tr class=\"info\"><td class=\"info\" align=\"left\">Abwesende Klassen&nbsp;</td><td class=\"info\" align=\"left\">6a, 6b, 6c, 6d, 6e</td></tr></table><p><table class=\"mon_list\" ><tr class='list'><th class=\"list\" align=\"center\">Std.</th><th class=\"list\" align=\"center\">Kl.</th><th class=\"list\" align=\"center\">Vertreter</th><th class=\"list\" align=\"center\">statt</th><th class=\"list\" align=\"center\">Fach</th><th class=\"list\" align=\"center\">Raum</th><th class=\"list\" align=\"center\">Verlegung</th><th class=\"list\" align=\"center\">Art</th><th class=\"list\" align=\"center\">Anmerkungen</th></tr><tr class='list odd'><td class=\"list inline_header\" colspan=\"9\" >5a  Sho/Tei</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">5a</td><td class=\"list\" align=\"center\">KLA</td><td class=\"list\" align=\"center\"><strike>BRO</strike></td><td class=\"list\" align=\"center\">E</td><td class=\"list\" align=\"center\">R03</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">5</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">5a</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HLS</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">BER</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">SP</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">GYMH</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">6</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">5a</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HAS</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">BER</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">SP</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">GYMH</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list inline_header\" colspan=\"9\" >5d  Otm/Kue</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">5d</td><td class=\"list\" align=\"center\">KNK</td><td class=\"list\" align=\"center\"><strike>TEI</strike></td><td class=\"list\" align=\"center\">E</td><td class=\"list\" align=\"center\">R08</td><td class=\"list\" align=\"center\">Entfall fÃ¼r Lehrer</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">5d</td><td class=\"list\" align=\"center\">TEI</td><td class=\"list\" align=\"center\"><strike>TEI</strike></td><td class=\"list\" align=\"center\">E</td><td class=\"list\" align=\"center\">R08</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Raum-Vtr.</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >7a  Hko/Tik</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">7a</td><td class=\"list\" align=\"center\"><strike>MYR</strike></td><td class=\"list\" align=\"center\"><strike>MYR</strike></td><td class=\"list\" align=\"center\"><strike>CH</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">7a</td><td class=\"list\" align=\"center\">HLT</td><td class=\"list\" align=\"center\"><strike>MYR</strike></td><td class=\"list\" align=\"center\">CH</td><td class=\"list\" align=\"center\">CH1</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">7a</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">KEM</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">BER</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">SP</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">R09</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >7b  Nfb/Bro</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">7b</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">SHH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">PAP</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">SP</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HT3</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >7e  Shi/Bec</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">7e</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">KDY</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">SPE</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">M</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">R115</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr></table><p><font size=\"3\" face=\"Arial\">24.9.2015 A (39)   gÃ¼ltig  ab 20.08.2014   DB~168804~2013-2014~1</font></center><p><center><font face=\"Arial\" size=\"2\"><a href=\"http://www.grupet.at\" target=\"_blank\" >Untis Stundenplan Software</a></font></center><table class=\"mon_head\">    <tr>        <td valign=\"bottom\"><h1><strong>Untis</strong> 2016 <!-- Info-Stundenplan --></h1></td>        <td valign=\"bottom\"></td>        <td align=\"right\" valign=\"bottom\">            <p>STÃ„DT. GYMNASIUM LÃ–HNE <span style=\"width:10px\">&nbsp;</span> D-32584, A.-SCHWEITZER-STR.16<br />            1. Halbjahr 15/16<span style=\"width:10px\">&nbsp;</span> <span style=\"width:10px\">&nbsp;</span> Stand: 23.09.2015 07:03</p>        </td>    </tr></table><center><div class=\"mon_title\">24.9.2015 Donnerstag, Woche A (Seite 2 / 5)</div><table class=\"mon_list\" ><tr class='list'><th class=\"list\" align=\"center\">Std.</th><th class=\"list\" align=\"center\">Kl.</th><th class=\"list\" align=\"center\">Vertreter</th><th class=\"list\" align=\"center\">statt</th><th class=\"list\" align=\"center\">Fach</th><th class=\"list\" align=\"center\">Raum</th><th class=\"list\" align=\"center\">Verlegung</th><th class=\"list\" align=\"center\">Art</th><th class=\"list\" align=\"center\">Anmerkungen</th></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >7e  Shi/Bec</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">5</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">7e</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">MAR</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">SHI</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">D</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">R115</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >8a  Kun/Dau</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">8a, 8b, 8c, 8d, 8e</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HOH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">LAN</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">WP-PH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">PH1</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >8b  Zck/Hls</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">8a, 8b, 8c, 8d, 8e</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HOH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">LAN</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">WP-PH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">PH1</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >8c  Kas/Rob</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">8a, 8b, 8c, 8d, 8e</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HOH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">LAN</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">WP-PH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">PH1</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >8d  Pal/Bsh</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">8d</td><td class=\"list\" align=\"center\"><strike>BSH</strike></td><td class=\"list\" align=\"center\"><strike>BSH</strike></td><td class=\"list\" align=\"center\"><strike>M</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">8d</td><td class=\"list\" align=\"center\">KNK</td><td class=\"list\" align=\"center\"><strike>BSH</strike></td><td class=\"list\" align=\"center\">M</td><td class=\"list\" align=\"center\">R117</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">8a, 8b, 8c, 8d, 8e</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HOH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">LAN</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">WP-PH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">PH1</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >8e  Kem/Kdy</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">3 - 4</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">8a, 8b, 8c, 8d, 8e</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">HOH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">LAN</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">WP-PH</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">PH1</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >9a  Pei/Bev</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">MAR</td><td class=\"list\" align=\"center\"><strike>MAR</strike></td><td class=\"list\" align=\"center\">PP</td><td class=\"list\" align=\"center\">N12</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Raum-Vtr.</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>ER</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>KR</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list even'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">HKO</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\">ER</td><td class=\"list\" align=\"center\">R205</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">KUE</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\">KR</td><td class=\"list\" align=\"center\">R204</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr></table><p><font size=\"3\" face=\"Arial\">24.9.2015 A (39)   gÃ¼ltig  ab 20.08.2014   DB~168804~2013-2014~1</font></center><p><center><font face=\"Arial\" size=\"2\"><a href=\"http://www.grupet.at\" target=\"_blank\" >Untis Stundenplan Software</a></font></center><table class=\"mon_head\">    <tr>        <td valign=\"bottom\"><h1><strong>Untis</strong> 2016 <!-- Info-Stundenplan --></h1></td>        <td valign=\"bottom\"></td>        <td align=\"right\" valign=\"bottom\">            <p>STÃ„DT. GYMNASIUM LÃ–HNE <span style=\"width:10px\">&nbsp;</span> D-32584, A.-SCHWEITZER-STR.16<br />            1. Halbjahr 15/16<span style=\"width:10px\">&nbsp;</span> <span style=\"width:10px\">&nbsp;</span> Stand: 23.09.2015 07:03</p>        </td>    </tr></table><center><div class=\"mon_title\">24.9.2015 Donnerstag, Woche A (Seite 3 / 5)</div><table class=\"mon_list\" ><tr class='list'><th class=\"list\" align=\"center\">Std.</th><th class=\"list\" align=\"center\">Kl.</th><th class=\"list\" align=\"center\">Vertreter</th><th class=\"list\" align=\"center\">statt</th><th class=\"list\" align=\"center\">Fach</th><th class=\"list\" align=\"center\">Raum</th><th class=\"list\" align=\"center\">Verlegung</th><th class=\"list\" align=\"center\">Art</th><th class=\"list\" align=\"center\">Anmerkungen</th></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >9a  Pei/Bev</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">5</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">9a</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">KDY</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><strike><span style=\"color: #E80000\">PAP</span></strike></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">F</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">R201</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Statt-Vertretung</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Aufg . Klassenbuch</span></td></tr><tr class='list even'><td class=\"list\" align=\"center\">6</td><td class=\"list\" align=\"center\">9a</td><td class=\"list\" align=\"center\">HLS</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\">ERg</td><td class=\"list\" align=\"center\">R202</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list inline_header\" colspan=\"9\" >9b  Lab/Mey</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">MAR</td><td class=\"list\" align=\"center\"><strike>MAR</strike></td><td class=\"list\" align=\"center\">PP</td><td class=\"list\" align=\"center\">N12</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Raum-Vtr.</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>ER</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>KR</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">HKO</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\">ER</td><td class=\"list\" align=\"center\">R205</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">KUE</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\">KR</td><td class=\"list\" align=\"center\">R204</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list inline_header\" colspan=\"9\" >9c  Knk/Bat</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">MAR</td><td class=\"list\" align=\"center\"><strike>MAR</strike></td><td class=\"list\" align=\"center\">PP</td><td class=\"list\" align=\"center\">N12</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Raum-Vtr.</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>ER</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>KR</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">HKO</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\">ER</td><td class=\"list\" align=\"center\">R205</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">KUE</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\">KR</td><td class=\"list\" align=\"center\">R204</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list inline_header\" colspan=\"9\" >9d  Hlt/Hse</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">MAR</td><td class=\"list\" align=\"center\"><strike>MAR</strike></td><td class=\"list\" align=\"center\">PP</td><td class=\"list\" align=\"center\">N12</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Raum-Vtr.</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\"><strike>ER</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\"><strike>KR</strike></td><td class=\"list\" align=\"center\">---</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">Entfall</td><td class=\"list\" align=\"center\">NUR Reli Bev und Lan entfÃ¤llt!</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">HKO</td><td class=\"list\" align=\"center\"><strike>BEV</strike></td><td class=\"list\" align=\"center\">ER</td><td class=\"list\" align=\"center\">R205</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr></table><p><font size=\"3\" face=\"Arial\">24.9.2015 A (39)   gÃ¼ltig  ab 20.08.2014   DB~168804~2013-2014~1</font></center><p><center><font face=\"Arial\" size=\"2\"><a href=\"http://www.grupet.at\" target=\"_blank\" >Untis Stundenplan Software</a></font></center><table class=\"mon_head\">    <tr>        <td valign=\"bottom\"><h1><strong>Untis</strong> 2016 <!-- Info-Stundenplan --></h1></td>        <td valign=\"bottom\"></td>        <td align=\"right\" valign=\"bottom\">            <p>STÃ„DT. GYMNASIUM LÃ–HNE <span style=\"width:10px\">&nbsp;</span> D-32584, A.-SCHWEITZER-STR.16<br />            1. Halbjahr 15/16<span style=\"width:10px\">&nbsp;</span> <span style=\"width:10px\">&nbsp;</span> Stand: 23.09.2015 07:03</p>        </td>    </tr></table><center><div class=\"mon_title\">24.9.2015 Donnerstag, Woche A (Seite 4 / 5)</div><table class=\"mon_list\" ><tr class='list'><th class=\"list\" align=\"center\">Std.</th><th class=\"list\" align=\"center\">Kl.</th><th class=\"list\" align=\"center\">Vertreter</th><th class=\"list\" align=\"center\">statt</th><th class=\"list\" align=\"center\">Fach</th><th class=\"list\" align=\"center\">Raum</th><th class=\"list\" align=\"center\">Verlegung</th><th class=\"list\" align=\"center\">Art</th><th class=\"list\" align=\"center\">Anmerkungen</th></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >9d  Hlt/Hse</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">2</td><td class=\"list\" align=\"center\">9a, 9b, 9c, 9d</td><td class=\"list\" align=\"center\">KUE</td><td class=\"list\" align=\"center\"><strike>LAN</strike></td><td class=\"list\" align=\"center\">KR</td><td class=\"list\" align=\"center\">R204</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Statt-Vertretung</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >EF  Keu/Hse</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">EF</td><td class=\"list\" align=\"center\">BAT</td><td class=\"list\" align=\"center\"><strike>BAT</strike></td><td class=\"list\" align=\"center\">GK01-EK</td><td class=\"list\" align=\"center\">N14</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">Raum-Vtr.</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">EF</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>SHI</strike></td><td class=\"list\" align=\"center\">GK01-D</td><td class=\"list\" align=\"center\">N26</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">3 - 4</td><td class=\"list\" align=\"center\">EF</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>BSH</strike></td><td class=\"list\" align=\"center\">GK12-M</td><td class=\"list\" align=\"center\">N15</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">5 - 6</td><td class=\"list\" align=\"center\">EF</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>KEU</strike></td><td class=\"list\" align=\"center\">GK10-CH</td><td class=\"list\" align=\"center\">CH1</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">7 - 8</td><td class=\"list\" align=\"center\">EF</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>KEU</strike></td><td class=\"list\" align=\"center\">GK02-BI</td><td class=\"list\" align=\"center\">BIO1</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >Q1  Har/Bie</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">Q1</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>SUN</strike></td><td class=\"list\" align=\"center\">GK04-M</td><td class=\"list\" align=\"center\">N15</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">7 - 8</td><td class=\"list\" align=\"center\">Q1</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>BIE</strike></td><td class=\"list\" align=\"center\">LK01-BI</td><td class=\"list\" align=\"center\">BI-PH</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">9 - 10</td><td class=\"list\" align=\"center\">Q1</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>KEU</strike></td><td class=\"list\" align=\"center\">GK03-S0</td><td class=\"list\" align=\"center\">CH1</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list inline_header\" colspan=\"9\" >Q2  Shu/Mer</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">Q2</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>SPE</strike></td><td class=\"list\" align=\"center\">GK06-M</td><td class=\"list\" align=\"center\">N21</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">1 - 2</td><td class=\"list\" align=\"center\">Q2</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>LIN</strike></td><td class=\"list\" align=\"center\">GK06-KU</td><td class=\"list\" align=\"center\">WERK</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">3 - 4</td><td class=\"list\" align=\"center\">Q2</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>SHI</strike></td><td class=\"list\" align=\"center\">LK01-D</td><td class=\"list\" align=\"center\">N25</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">5 - 6</td><td class=\"list\" align=\"center\">Q2</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>BSH</strike></td><td class=\"list\" align=\"center\">GK03-M</td><td class=\"list\" align=\"center\">N26</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\">7 - 8</td><td class=\"list\" align=\"center\">Q2</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>NEU</strike></td><td class=\"list\" align=\"center\">GK10-SP</td><td class=\"list\" align=\"center\">HT2</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list even'><td class=\"list\" align=\"center\">9 - 10</td><td class=\"list\" align=\"center\">Q2</td><td class=\"list\" align=\"center\">+</td><td class=\"list\" align=\"center\"><strike>NEU</strike></td><td class=\"list\" align=\"center\">GK01-SW</td><td class=\"list\" align=\"center\">N24 W</td><td class=\"list\">&nbsp;</td><td class=\"list\" align=\"center\">eigenverant. Arbeiten</td><td class=\"list\" align=\"center\">&nbsp;</td></tr></table><p><font size=\"3\" face=\"Arial\">24.9.2015 A (39)   gÃ¼ltig  ab 20.08.2014   DB~168804~2013-2014~1</font></center><p><center><font face=\"Arial\" size=\"2\"><a href=\"http://www.grupet.at\" target=\"_blank\" >Untis Stundenplan Software</a></font></center><table class=\"mon_head\">    <tr>        <td valign=\"bottom\"><h1><strong>Untis</strong> 2016 <!-- Info-Stundenplan --></h1></td>        <td valign=\"bottom\"></td>        <td align=\"right\" valign=\"bottom\">            <p>STÃ„DT. GYMNASIUM LÃ–HNE <span style=\"width:10px\">&nbsp;</span> D-32584, A.-SCHWEITZER-STR.16<br />            1. Halbjahr 15/16<span style=\"width:10px\">&nbsp;</span> <span style=\"width:10px\">&nbsp;</span> Stand: 23.09.2015 07:03</p>        </td>    </tr></table><center><div class=\"mon_title\">24.9.2015 Donnerstag, Woche A (Seite 5 / 5)</div><table class=\"mon_list\" ><tr class='list'><th class=\"list\" align=\"center\">Std.</th><th class=\"list\" align=\"center\">Kl.</th><th class=\"list\" align=\"center\">Vertreter</th><th class=\"list\" align=\"center\">statt</th><th class=\"list\" align=\"center\">Fach</th><th class=\"list\" align=\"center\">Raum</th><th class=\"list\" align=\"center\">Verlegung</th><th class=\"list\" align=\"center\">Art</th><th class=\"list\" align=\"center\">Anmerkungen</th></tr><tr class='list odd'><td class=\"list inline_header\" colspan=\"9\" >AKO  Ref-Betreuung</td></tr><tr class='list even'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">1</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">AKO</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">SAA</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Sondereins.</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr><tr class='list odd'><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">2</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">AKO</span></td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">SAA</span></td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" style=\"background-color: #FFFFFF\" >&nbsp;</td><td class=\"list\" align=\"center\" style=\"background-color: #FFFFFF\" ><span style=\"color: #E80000\">Sondereins.</span></td><td class=\"list\" align=\"center\">&nbsp;</td></tr></table><p><font size=\"3\" face=\"Arial\">24.9.2015 A (39)   gÃ¼ltig  ab 20.08.2014   DB~168804~2013-2014~1</font></center><p><center><font face=\"Arial\" size=\"2\"><a href=\"http://www.grupet.at\" target=\"_blank\" >Untis Stundenplan Software</a></font></center><script language=\"JavaScript\"><!--var AktiverTimer;var stop = 0;var iSchritteNachUnten = 0;var iSchritteNachOben = 0;var iMinPosition = 0;var iPosition = 0;var iVerzoegerungPixel = getPageVisibleArea();var iSekPause = 4;var iSekLetztePause = 5;var iMaxPosition = getPageHeight();var iGeschwidigkeit = 10;var iLetzteVerzoegerung = 0;function initme(){iMaxPosition = getPageHeight();iVerzoegerungPixel = getPageVisibleArea();iDocumentHeight =  getDocumentHeight();}function NachUnten(){iSchritteNachUnten = iSchritteNachUnten+1;initme();if (stop == 0){iPosition = iPosition+1;if (iMaxPosition > 0){    if (iPosition <= iMaxPosition )    {            window.scrollBy(0, 1);            if (iLetzteVerzoegerung == iVerzoegerungPixel)            {            iLetzteVerzoegerung = 0;            window.clearTimeout(AktiverTimer);            AktiverTimer = window.setTimeout(\"NachUnten()\", (iSekPause * 1000));            }            else if(iPosition == (iMaxPosition - 1))            {            iLetzteVerzoegerung = iLetzteVerzoegerung + 1;            window.clearTimeout(AktiverTimer);            AktiverTimer = window.setTimeout(\"NachUnten()\", (iSekLetztePause * 1000));            }            else            {            iLetzteVerzoegerung = iLetzteVerzoegerung + 1;            window.clearTimeout(AktiverTimer);            AktiverTimer = window.setTimeout(\"NachUnten()\", iGeschwidigkeit);            }    }    else    {    iLetzteVerzoegerung = 0;    iPosition = 0;    window.scrollTo(0, 0);    window.clearTimeout(AktiverTimer);    AktiverTimer = window.setTimeout(\"NachUnten()\", (iSekPause * 1000));    }}     }     }function Stop(){stop = 1;}function Start(){stop = 0;}function NachOben(){iSchritteNachOben = iSchritteNachOben+1;initme();if (stop == 0){iPosition = iPosition-1;if (iPosition > iMinPosition){    window.scrollBy(0, -1);    if (iLetzteVerzoegerung == iVerzoegerungPixel)    {    iLetzteVerzoegerung = 0;    window.clearTimeout(AktiverTimer);    AktiverTimer = window.setTimeout(\"NachOben()\", (iSekPause * 1000));    }    else if(iPosition == (iMinPosition + 1))    {    iLetzteVerzoegerung = iLetzteVerzoegerung + 1;    window.clearTimeout(AktiverTimer);    AktiverTimer = window.setTimeout(\"NachOben()\", (iSekPause * 1000));    }    else    {    iLetzteVerzoegerung = iLetzteVerzoegerung + 1;    window.clearTimeout(AktiverTimer);    AktiverTimer = window.setTimeout(\"NachOben()\", iGeschwidigkeit);    }}else{iLetzteVerzoegerung = 0;    NachUnten();}     }     }function getDocumentHeight(){   if (document.body.scrollHeight)return document.body.scrollHeight;return document.documentElement.offsetHeight;} function getPageHeight(){   return (getDocumentHeight() - getPageVisibleArea());} function getPageVisibleArea(){ if (window.innerHeight) {return (window.innerHeight); } else {return (document.body.offsetHeight); }} var touchtimer;function touch() {Stop();clearTimeout(touchtimer);touchtimer=setTimeout(function(){Start();NachUnten();},30000);}document.addEventListener(\"touchstart\", touch, true);document.addEventListener(\"click\", touch, true);NachUnten();//--></script></body></html>");

            // Motd
            day.setMotd(parseMotd(vertretungsplanDoc));

            // Timestamp
            day.setTimestamp(
                    vertretungsplanDoc.select("table.mon_head").first().text().split("Stand: ")[1]);

            // Date
            String[] dateSplits = vertretungsplanDoc.select("div.mon_title").first().text().split(" ");
            day.setDate(dateSplits[0]);
            day.setDayName(dateSplits[1].replace(",", ""));

            // Every row with data
            Elements rows = vertretungsplanDoc.select("td.list:not(.inline_header)"); // Without "5a ..." row

            for (List<Element> elements : Lists.partition(rows, COLUMNS_COUNT)) {
                Vertretung vertretung = new Vertretung();
                vertretung.setZeitraum(getTrimmedText(elements, 0));
                vertretung.setKlasse(getTrimmedText(elements, 1));
                vertretung.setVertreter(getTrimmedText(elements, 2));
                vertretung.setStatt(getTrimmedText(elements, 3));
                vertretung.setFach(getTrimmedText(elements, 4));
                vertretung.setRaum(getTrimmedText(elements, 5));
                vertretung.setVerlegung(getTrimmedText(elements, 6));
                vertretung.setArt(getTrimmedText(elements, 7));
                vertretung.setZusatzinfo(getTrimmedText(elements, 8));
                day.getVertretungList().add(vertretung);
            }

            vertretungsplan.getDays().add(day);
        }

        return new VertretungsplanAndLogin(vertretungsplan, login);
    }

    @Override
    protected abstract void onSuccess(VertretungsplanAndLogin vertretungsplanAndLogin) throws Exception;

    @Override
    protected abstract void onException(Exception e) throws RuntimeException;

    /**
     * Parses the MOTD, message of the day("Nachrichten zum Tag")
     * @param document The root Document
     * @return The formatted String containing the motd or null if there isn't such a row
     */
    private @Nullable String parseMotd(@NonNull Document document) {
        // Getting first child as it should really be the only one
        Element motd = document.select("tr.info:last-child > td:only-child").first();
        if (motd != null) {
            StringBuilder motdTextBuilder = new StringBuilder();
            List<Node> childNodes = motd.childNodes();
            for (Node childNode : childNodes) {
                if (childNode instanceof Element) {
                    if (((Element) childNode).tagName().equalsIgnoreCase("br")) {
                        motdTextBuilder.append("\n");
                    } else {
                        // Removing leading space because one was added previously in loop
                        motdTextBuilder.append(CharMatcher.WHITESPACE.trimLeadingFrom(((Element) childNode).text()));
                    }
                } else if (childNode instanceof TextNode) {
                    motdTextBuilder.append(CharMatcher.WHITESPACE.trimLeadingFrom(((TextNode) childNode).text()));
                }

                // Fixing spaces
                char[] lastTwoChars = new char[2];
                motdTextBuilder.getChars(motdTextBuilder.length() - lastTwoChars.length,
                        motdTextBuilder.length(), lastTwoChars, 0);
                if (!CharMatcher.WHITESPACE.matches(lastTwoChars[lastTwoChars.length-1]) &&
                        !String.valueOf(lastTwoChars).equalsIgnoreCase("\n")) {
                    // Last char is not WHITESPACE and last chars aren't new line
                    motdTextBuilder.append(" ");
                }
            }
            return motdTextBuilder.toString();
        }
        return null;
    }

    /**
     * Gets the trimmed text of an Element
     * @param element The Element to get the text from
     * @return Trimmed text of Element
     */
    private String getTrimmedText(Element element) {
        // Using Guava because non-breaking space isn't trimmed by Java's native trim()
        return CharMatcher.WHITESPACE.trimFrom(element.text());
    }

    private String getTrimmedText(List<Element> elements, int index) {
        return getTrimmedText(elements.get(index));
    }
}
